// STRLEN.c
// Generated by decompiling STRLEN
// using Decompiler version 0.5.5.0.

#include "STRLEN.h"

void fn00001000(int32 d0, byte * a0)
{
	Eq_4 * a6_8 = *0x00000004;
	int32 d2_3 = d0;
	byte * a2_241 = a0;
	Eq_11 * a4_6 = 0x000093BE;
	if (a6_8->w0014 - 0x24 < 0x00)
	{
		word32 * a0_495 = 0x000013C8;
		word32 d0_498 = 0x0C;
		do
		{
			*a0_495 = 0x00;
			a0_495 = a0_495 + 0x01;
			d0_498 = d0_498 - 0x01;
		} while (d0_498 != 0x00);
	}
	a4_6->ptrFFFF800A = fp;
	a4_6->ptrFFFF800E = a6_8;
	Eq_27 * d0_19 = FindTask(0x00);
	Eq_33 * d0_110 = OpenLibrary(0x000012BC, 0x00);
	if (d0_110 != null)
	{
		int32 d4_450;
		a4_6->ptrFFFF8012 = d0_110;
		if (d0_19->ptr00AC == null)
		{
			d4_450 = 0x02;
			d2_3 = 0x08;
		}
		else
		{
			byte * a0_453 = a0;
			d4_450 = 0x03;
			do
			{
				if (*a0_507 - 0x20 == 0x00)
					d4_450 = DPB(d4_450, (word16) d4_450 + 0x01, 0);
				a0_453 = a0_507 + 0x01;
				byte * a0_507 = a0_453;
			} while (*a0_507 != 0x00);
		}
		ui32 d0_103 = d4_450 << 0x02;
		word32 d0_105 = d0_103 + d2_3;
		int32 d1_109 = 0x00010001;
		d0_110 = AllocMem(d0_105 + 0x11, 0x00010001);
		if (d0_110 != null)
		{
			Eq_68 * dwLoc14_156;
			word32 a0_161;
			d0_110->dw0000 = d0_105 + 0x11;
			word32 d4_121 = d4_450 - 0x01;
			d0_110->dw000C = d4_121;
			d0_110->dw0008 = d0_110->dw000C + 0x01 + d0_103 / 0x0010;
			Mem129[0x00:word32] = 0x00;
			Eq_68 * d0_130 = d0_19->ptr00AC;
			d0_130->dw0000 = d0_105 + 0x11;
			d0_130->dw000C = d4_121 - 0x01;
			Mem146[d0_130 + 0x08:word32] = d0_130 + 0x0010 + d0_103;
			Mem148[0x00:word32] = 0x00;
			Eq_68 * d0_149 = d0_19->ptr00AC;
			if (d0_149 == null)
			{
				fn00001214(d0_19);
				a4_6->ptrFFFF8016 = d0_149;
				a4_6->ptrFFFF801A = d0_149;
				Mem394[0x00:word32] = 0x00;
				dwLoc14_156 = d0_149;
				int32 d0_397 = d0_149->dw0024;
				if (d0_397 != 0x00)
					Enable();
				Supervisor(d0_130);
				d0_130->dw0004 = d0_397;
				if (d0_397 == 0x00)
				{
					fn0000127C(0x0014);
					return;
				}
				a4_6->dwFFFF801E = d0_397;
				a4_6->dwFFFF8022 = d0_397;
				a4_6->dwFFFF8026 = d0_397;
				d0_19->dw009C = d0_397;
				d0_19->dw00A0 = d0_397;
				word32 d0_422 = ((word32[]) 0x08)[d0_397];
				if (d0_422 != 0x00)
					d0_19->dw00A4 = d0_422;
l000011F8:
				a0_161 = d0_19->dw003A;
				goto l00001202;
			}
			ui32 d0_198 = ((ui32[]) 0x0010)[d0_149];
			ptr32 a0_205 = (d0_198 << 0x02) + 0x01;
			int32 d0_206 = (int32) null[d0_198].b0000;
			Mem207[a0_205 + d0_206:byte] = 0x00;
			d0_130->ptr0010 = a0_205;
			ui32 d0_213 = ((ui32[]) 0x0010)[d0_206];
			byte * a1_216 = d0_130->ptr0008;
			ptr32 a0_221 = (d0_213 << 0x02) + 0x01;
			int32 d0_222 = (int32) null[d0_213].b0000;
			Mem223[a0_221 + d0_222:byte] = 0x00;
			d0_130->ptr0010 = a0_221;
			byte * * a6_226 = d0_130->ptr0010 + 0x01;
			int32 d3_227 = 0x01;
			Eq_237 * a0_229 = a0 + d2_3;
			do
				a0_229 = a0_229 - (Eq_246 *) 0x01;
			while (d2_3 != ~0x00);
			Mem235[a0_229 + 0x01:byte] = 0x00;
			word32 d2_234 = d2_3 - 0x01;
			do
			{
l000010E6:
				byte v37_250 = *a2_241;
				a2_241 = a2_241 + 0x01;
				d1_109 = DPB(d1_109, v37_250, 0);
				if (v37_250 == 0x00)
					goto l00001148;
			} while ((byte) d1_109 - 0x20 == 0x00 || (byte) d1_109 - 0x09 == 0x00);
			if (d3_227 - d0_130->dw000C != 0x00)
			{
				Mem306[a6_226 + 0x00:word32] = a1_216;
				a6_226 = a6_226;
				d3_227 = DPB(d3_227, (word16) d3_227 + 0x01, 0);
				if ((byte) d1_109 - 0x22 != 0x00)
				{
					*a1_216 = (byte) d1_109;
					a1_216 = a1_216 + 0x01;
					while (true)
					{
						byte v45_332 = *a2_241;
						a2_241 = a2_241 + 0x01;
						d1_109 = DPB(d1_109, v45_332, 0);
						if (v45_332 == 0x00)
							break;
						if ((byte) d1_109 - 0x20 == 0x00)
							goto l00001116;
						*a1_216 = (byte) d1_109;
						a1_216 = a1_216 + 0x01;
					}
				}
				else
					while (true)
					{
						byte v70_348 = *a2_241;
						a2_241 = a2_241 + 0x01;
						d1_109 = DPB(d1_109, v70_348, 0);
						if (v70_348 == 0x00)
							break;
						if ((byte) d1_109 - 0x22 == 0x00)
						{
l00001116:
							*a1_216 = 0x00;
							a1_216 = a1_216 + 0x01;
							goto l000010E6;
						}
						if ((byte) d1_109 - 0x2A == 0x00)
						{
							d1_109 = DPB(d1_109, *a2_241, 0);
							d2_234 = DPB(d2_234, (byte) DPB(d2_234, (byte) d1_109, 0) & 223, 0);
							a2_241 = a2_241 + 0x01;
							if ((byte) d2_234 - 0x4E == 0x00)
								d1_109 = 0x0A;
							else if ((byte) d2_234 - 0x45 == 0x00)
								d1_109 = 0x001B;
						}
						*a1_216 = (byte) d1_109;
						a1_216 = a1_216 + 0x01;
					}
			}
l00001148:
			*a1_216 = 0x00;
			*a6_226 = 0x00;
			execPrivate4();
			a4_6->dwFFFF801E = d0_222;
			execPrivate5();
			a4_6->dwFFFF8022 = d0_222;
			dwLoc14_156 = &d0_130->ptr0010;
			dwLoc18 = d3_227;
			if (a4_6->ptrFFFF800E->w0014 - 0x24 >= 0x00)
			{
				int32 v87_292 = d0_19->dw00E0;
				a4_6->dwFFFF8026 = v87_292;
				if (v87_292 != 0x00)
				{
l0000117E:
					if (d0_19->b0008 - 0x0D == 0x00)
					{
						word32 * a0_282 = d0_19->ptr00B0;
						a0_161 = a0_282 + 0x01 - *a0_282;
l00001202:
						a4_6->dwFFFF8032 = a0_161;
						a4_6->ptrFFFF8036 = fp - 0x18;
						fn00001354(dwLoc18, dwLoc14_156);
						fn0000127C(0x00);
						return;
					}
					goto l000011F8;
				}
			}
			a4_6->dwFFFF8026 = d0_222;
			goto l0000117E;
		}
		CloseLibrary(a4_6->ptrFFFF8012);
		Alert(0x00010000);
	}
	else
		Alert(0x00038007);
	if (d0_19->ptr00AC == null)
	{
		fn00001214(d0_19);
		fn0000126C(d0_110);
	}
	return;
}

void fn00001214(Eq_27 * a3)
{
	WaitPort(a3 + 0x005C);
	GetMsg(a3 + 0x005C);
	return;
}

void fn0000126C(Eq_33 * a2)
{
	Forbid();
	ReplyMsg(a2);
	return;
}

void fn00001278(word32 dwArg04)
{
	fn0000127C(dwArg04);
	return;
}

void fn0000127C(int32 d2)
{
	Eq_541 * a4_0 = 0x000093BE;
	Eq_33 * * a7_3 = a4_0->ptrFFFF800A;
	Eq_33 * v7_8 = *(a7_3 - 0x04);
	Eq_33 * v5_5 = *(a7_3 - 0x08);
	if (v7_8->dw0004 != 0x00)
		execPrivate1();
	CloseLibrary(a4_0->ptrFFFF8012);
	if (v5_5 != null)
		fn0000126C(v5_5);
	FreeMem(v7_8, v7_8->dw0000);
	return;
}

void fn000012D0(word32 dwArg04)
{
	Eq_585 * a3_11 = 0x00001404;
	if (0x1404 != 0x00)
	{
		int32 d2_39 = 0x01;
		if (a3_11[0x04] != 0x00)
			do
				d2_39 = d2_39 + 0x01;
			while (a3_11[d2_39 * 0x04] != 0x00);
		ui32 d2_49 = d2_39 - 0x01;
		if (d2_49 != 0x00)
			do
			{
				int32 d0_55 = d2_49 << 0x02;
				code * a2_57 = a3_11[d0_55];
				ERROR: EQ_619.DataType is Null a7_59;
				ERROR: EQ_620.DataType is Null a2_61;
				word32 d2_62;
				ERROR: EQ_622.DataType is Null d0_63;
				ERROR: EQ_623.DataType is Null CVZN_64;
				ERROR: EQ_624.DataType is Null Z_65;
				ERROR: EQ_625.DataType is Null ZN_66;
				ERROR: EQ_626.DataType is Null C_67;
				ERROR: EQ_627.DataType is Null V_68;
				ERROR: EQ_628.DataType is Null CVZNX_69;
				a2_57();
				d2_49 = d2_62 - 0x01;
			} while (d2_62 != 0x01);
	}
	fn00001278(dwArg04);
	return;
}

void fn0000131C(word32 dwArg04)
{
	if (*0x000013F8 == 0x00)
	{
		Eq_640 * a3_28 = *0x0000140C;
		*0x000013F8 = 0x01;
		if (a3_28 != null)
			do
			{
				code * a2_50 = a3_28->ptr0004;
				ERROR: EQ_660.DataType is Null a7_51;
				Eq_640 * * a3_52;
				ERROR: EQ_662.DataType is Null a2_53;
				ERROR: EQ_663.DataType is Null ZN_54;
				ERROR: EQ_664.DataType is Null C_55;
				ERROR: EQ_665.DataType is Null V_56;
				ERROR: EQ_666.DataType is Null Z_57;
				ERROR: EQ_667.DataType is Null d0_58;
				ERROR: EQ_668.DataType is Null CVZN_59;
				a2_50();
				a3_28 = Mem31[a3_52 + 0x00:word32];
			} while (a3_28 != null);
		fn000012D0(dwArg04);
	}
	return;
}

void fn00001354(int32 dwArg04, Eq_68 * dwArg08)
{
	code * * a3_45 = 0x00001400;
	if (5116 != 0x00 && *a3_45 != null)
		do
		{
			ERROR: EQ_690.DataType is Null a7_52;
			ERROR: EQ_691.DataType is Null a2_54;
			ERROR: EQ_692.DataType is Null d0_55;
			ERROR: EQ_693.DataType is Null CVZN_56;
			ERROR: EQ_694.DataType is Null Z_57;
			ERROR: EQ_695.DataType is Null ZN_58;
			ERROR: EQ_696.DataType is Null C_59;
			ERROR: EQ_697.DataType is Null V_60;
			(*a3_45)();
		} while (*a3_45 != null);
	fn0000131C(fn00001390());
	return;
}

word32 fn00001390()
{
	return fn000013AC(0x000013A4);
}

int32 fn000013AC(ptr32 dwArg04)
{
	byte * a1_11 = dwArg04;
	int32 d0_17 = 0x00;
	while (true)
	{
		a1_11 = a1_11 + 0x01;
		if (*a1_11 == 0x00)
			break;
		d0_17 = d0_17 + 0x01;
	}
	return d0_17;
}

