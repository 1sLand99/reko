// Sonic the Hedgehog.c
// Generated by decompiling D:\dev\uxmal\reko\master\subjects\SegaGenesis-m68k\Sonic the Hedgehog.bin
// using Decompiler version 0.5.5.0.

#include "Sonic the Hedgehog.h"

void Reset(word32 d0, word32 d1, word32 d5, word32 d6, word16 sr)
{
	byte Z_11 = cond(Mem0[0x00A10008 + 0x00:word32]);
	if (Mem0[0x00A10008 + 0x00:word32] == 0x00)
		Z_11 = cond(Mem0[0x00A1000C + 0x00:word16]);
	if (!Z_11)
	{
		word32 a5_168 = 0x00000294;
		word32 a1_177 = Mem0[a5_168 + 0x0A:word32];
		word32 d5_169 = Mem0[a5_168 + 0x00:word16];
		word32 d6_171 = Mem0[a5_168 + 0x02:word16];
		word32 d7_173 = Mem0[a5_168 + 0x04:word16];
		word32 a0_175 = Mem0[a5_168 + 0x06:word32];
		word32 a2_179 = Mem0[a5_168 + 0x0E:word32];
		word32 a3_181 = Mem0[a5_168 + 0x12:word32];
		word32 a4_183 = Mem0[a5_168 + 22:word32];
		word32 a5_184 = a5_168 + 0x1A;
		if ((Mem0[a1_177 + -0x000010FF:byte] & 0x0F) != 0x00)
			Mem321[a1_177 + 0x00002F00:word32] = 0x53454741;
		word32 a6_195 = 0x00;
		word32 d1_197 = 0x0017;
		do
		{
			word32 d5_204 = DPB(d5_169, Mem0[a5_184 + 0x00:byte], 0);
			Mem206[a4_183 + 0x00:word16] = (word16) d5_204;
			a5_184 = a5_184 + 0x01;
			d5_169 = DPB(d5_169, (word16) d5_204 + (word16) d7_173, 0);
			d1_197 = d1_197 - 0x01;
		} while (d1_197 != ~0x00);
		Mem214[a4_183 + 0x00:word32] = Mem206[a5_184 + 0x00:word32];
		Mem216[a3_181 + 0x00:word16] = 0x00;
		Mem218[a1_177 + 0x00:word16] = (word16) d7_173;
		Mem220[a2_179 + 0x00:word16] = (word16) d7_173;
		word32 a5_212 = a5_184 + 0x04;
		do
			;
		while (__btst(Mem220[a1_177 + 0x00:word32], 0x00));
		word32 d2_223 = 0x0025;
		do
		{
			Mem231[a0_175 + 0x00:byte] = Mem220[a5_212 + 0x00:byte];
			a5_212 = a5_212 + 0x01;
			a0_175 = a0_175 + 0x01;
			d2_223 = d2_223 - 0x01;
		} while (d2_223 != ~0x00);
		Mem236[a2_179 + 0x00:word16] = 0x00;
		Mem238[a1_177 + 0x00:word16] = 0x00;
		Mem240[a2_179 + 0x00:word16] = (word16) d7_173;
		do
		{
			a6_195 = a6_195 - 0x04;
			Mem246[a6_195 + 0x00:word32] = 0x00;
			d6_171 = d6_171 - 0x01;
		} while (d6_171 != ~0x00);
		Mem252[a4_183 + 0x00:word32] = Mem246[a5_212 + 0x00:word32];
		Mem256[a4_183 + 0x00:word32] = Mem252[a5_212 + 0x04:word32];
		word32 d3_257 = 0x001F;
		do
		{
			Mem261[a3_181 + 0x00:word32] = 0x00;
			d3_257 = d3_257 - 0x01;
		} while (d3_257 != ~0x00);
		Mem267[a4_183 + 0x00:word32] = Mem261[a5_212 + 0x08:word32];
		word32 a5_265 = a5_212 + 0x0C;
		word32 d4_268 = 0x0013;
		do
		{
			Mem272[a3_181 + 0x00:word32] = 0x00;
			d4_268 = d4_268 - 0x01;
		} while (d4_268 != ~0x00);
		word32 d5_275 = 0x03;
		do
		{
			Mem282[a3_181 + 0x0011:byte] = Mem272[a5_265 + 0x00:byte];
			a5_265 = a5_265 + 0x01;
			d5_275 = d5_275 - 0x01;
		} while (d5_275 != ~0x00);
		Mem286[a2_179 + 0x00:word16] = 0x00;
		d0 = Mem286[a6_195 + 0x00:word32];
		d1 = Mem286[a6_195 + 0x04:word32];
		d5 = Mem286[a6_195 + 0x14:word32];
		d6 = Mem286[a6_195 + 0x18:word32];
		sr = 0x2700;
	}
	if (__btst(Mem0[0x00A1000D + 0x00:byte], 0x06) || Mem0[0x0000FFFC + 0x00:word32] - 0x696E6974 != 0x00)
	{
		word32 a0_116 = 0x0200;
		word32 d0_118 = Mem0[0x01A4:word32];
		d1 = 0x00;
		do
		{
			word16 v58_125 = (word16) d1 + Mem0[a0_116 + 0x00:word16];
			a0_116 = a0_116 + 0x02;
			d1 = DPB(d1, v58_125, 0);
		} while (d0_118 - a0_116 >=u 0x00);
		if (v58_125 - Mem0[0x018E:word16] != 0x00)
		{
			fn00001222(d0_118, d1);
			Mem157[0x00C00004 + 0x00:word32] = 0xC0000000;
			word32 d7_158 = 0x003F;
			do
			{
				Mem162[0x00C00000 + 0x00:word16] = 0x0E;
				d7_158 = d7_158 - 0x01;
			} while (d7_158 != ~0x00);
			while (true)
				;
		}
		word32 a6_135 = 0x0000FE00;
		d6 = DPB(d6, 0x7F, 0);
		do
		{
			Mem142[a6_135 + 0x00:word32] = 0x00;
			a6_135 = a6_135 + 0x04;
			d6 = d6 - 0x01;
		} while (d6 != ~0x00);
		byte v62_146 = Mem142[0x00A10001 + 0x00:byte];
		Mem151[0x0000FFF8 + 0x00:byte] = v62_146 & 0xC0;
		Mem153[0x0000FFFC + 0x00:word32] = 0x696E6974;
		d0 = DPB(d0_118, v62_146 & 0xC0, 0);
	}
	word32 a6_67 = 0x00FF0000;
	word32 d6_69 = DPB(d6, 0x3F7F, 0);
	do
	{
		Mem74[a6_67 + 0x00:word32] = 0x00;
		a6_67 = a6_67 + 0x04;
		d6_69 = d6_69 - 0x01;
	} while (d6_69 != ~0x00);
	fn00001352(fn00001222(d0, d1), d1, d5, sr);
	word32 d0_105 = fn000011B6();
	Mem81[0x0000F600 + 0x00:byte] = 0x00;
	while (true)
	{
		word32 d0_87 = DPB(d0_105, (word16) DPB(d0_105, Mem81[0x0000F600 + 0x00:byte], 0) & 0x1C, 0);
		word32 a7_91;
		byte ZN_92;
		byte C_93;
		byte V_94;
		byte Z_95;
		word32 a5_96;
		word32 d5_97;
		word32 d6_98;
		word32 d7_99;
		word32 a0_100;
		word32 a1_101;
		word32 a2_102;
		word32 a3_103;
		word32 a4_104;
		byte CVZN_106;
		word32 a6_107;
		word32 usp_108;
		word32 d1_109;
		byte CVZNX_110;
		word32 d2_111;
		word32 d3_112;
		word32 d4_113;
		word16 sr_114;
		(0x00000396 + d0_87)();
	}
}

word32 fn000011B6()
{
	Mem3[0x00A11100 + 0x00:word16] = 0x0100;
	do
		;
	while (__btst(Mem3[0x00A11100 + 0x00:byte], 0x00));
	Mem8[0x00A10009 + 0x00:byte] = 0x40;
	Mem10[0x00A1000B + 0x00:byte] = 0x40;
	Mem12[0x00A1000D + 0x00:byte] = 0x40;
	Mem14[0x00A11100 + 0x00:word16] = 0x00;
	return 0x0040;
}

word32 fn00001222(word32 d0, word32 d1)
{
	word32 a0_2 = 0x00C00004;
	word32 a1_3 = 0x00C00000;
	word32 a2_11 = 0x0000129E;
	word32 d7_15 = 0x0012;
	do
	{
		Mem13[a0_2 + 0x00:word16] = Mem0[a2_11 + 0x00:word16];
		a2_11 = a2_11 + 0x02;
		d7_15 = d7_15 - 0x01;
	} while (d7_15 != ~0x00);
	Mem20[0x0000F60C + 0x00:word16] = Mem13[0x000012A0 + 0x00:word16];
	Mem22[0x0000F624 + 0x00:word16] = 35551;
	Mem25[0x00C00004 + 0x00:word32] = 0xC0000000;
	word32 d7_26 = DPB(d7_15, 0x3F, 0);
	do
	{
		Mem30[a1_3 + 0x00:word16] = 0x00;
		d7_26 = d7_26 - 0x01;
	} while (d7_26 != ~0x00);
	Mem33[0xF616:word32] = 0x00;
	Mem34[63002:word32] = 0x00;
	word32 a5_39 = 0x00C00004;
	Mem41[a5_39 + 0x00:word16] = 0x8F01;
	Mem43[a5_39 + 0x00:word32] = ~0x6B006C00;
	Mem45[a5_39 + 0x00:word16] = 0x9780;
	Mem47[a5_39 + 0x00:word32] = 0x40000080;
	Mem49[0x00C00000 + 0x00:word16] = 0x00;
	do
		;
	while (__btst((byte) Mem49[a5_39 + 0x00:word16], 0x01));
	Mem57[a5_39 + 0x00:word16] = 0x8F02;
	return 0x00;
}

void fn00001352(word32 d0, word32 d1, word32 d5, word16 sr)
{
	Mem3[0x00A11100 + 0x00:word16] = 0x0100;
	Mem5[0x00A11200 + 0x00:word16] = 0x0100;
	fn0000189C(d0, d1, d5, 0x00072E7C, 0x00A00000, sr);
	Mem14[0x00A11200 + 0x00:word16] = 0x00;
	Mem16[0x00A11200 + 0x00:word16] = 0x0100;
	Mem18[0x00A11100 + 0x00:word16] = 0x00;
	return;
}

void fn0000189C(word32 d0, word32 d1, word32 d5, word32 a0, word32 a1, word16 sr)
{
fn0000189C_entry:
l0000189C:
	word16 wLoc02_129 = DPB(wLoc02, Mem0[a0 + 0x01:byte], 0)
	word32 a0_10 = a0 + 0x02
	word32 d5_136 = DPB(d5, wLoc02_129, 0)
	word32 d4_145 = 0x0F
l000018A8:
	d5_136 = DPB(d5_136, (word16) d5_136 >>u 0x01, 0)
	d4_145 = d4_145 - 0x01
	branch d4_145 != ~0x00 l000018BA
l000018B0:
	word32 a0_257 = a0_10 + 0x01
	wLoc02_129 = DPB(wLoc02_129, Mem0[a0_257 + 0x00:byte], 0) (alias)
	a0_10 = a0_257 + 0x01
	d5_136 = DPB(d5_136, wLoc02_129, 0)
	d4_145 = 0x0F
l000018BA:
	branch sr >=u 0x00 l000018C2
l000018BE:
	Mem70[a1 + 0x00:byte] = Mem0[a0_10 + 0x00:byte]
	a0_10 = a0_10 + 0x01
	a1 = a1 + 0x01
	goto l000018A8
l000018C2:
	d5_136 = DPB(d5_136, (word16) d5_136 >>u 0x01, 0)
	d4_145 = d4_145 - 0x01
	branch d4_145 != ~0x00 l000018D6
l000018CC:
	word32 a0_244 = a0_10 + 0x01
	wLoc02_129 = DPB(wLoc02_129, Mem0[a0_244 + 0x00:byte], 0) (alias)
	a0_10 = a0_244 + 0x01
	d5_136 = DPB(d5_136, wLoc02_129, 0)
	d4_145 = 0x0F
l000018D6:
	word32 d3_105
	word32 d2_103
	branch sr <u 0x00 l00001906
l000018DA:
	word16 v33_116 = (word16) d5_136 >>u 0x01
	word32 d5_117 = DPB(d5_136, v33_116, 0)
	byte CVZNX_118 = cond(v33_116)
	word32 d4_126 = d4_145 - 0x01
	branch d4_126 != ~0x00 l000018EA
l000018E0:
	word32 a0_187 = a0_10 + 0x01
	wLoc02_129 = DPB(wLoc02_129, Mem0[a0_187 + 0x00:byte], 0) (alias)
	a0_10 = a0_187 + 0x01
	d5_117 = DPB(d5_136, wLoc02_129, 0)
	d4_126 = 0x0F
l000018EA:
	word16 v59_133 = __rcl(0x00, 0x01, CVZNX_118)
	word16 v61_135 = (word16) d5_117 >>u 0x01
	word32 d3_134 = (int32) v59_133
	d5_136 = DPB(d5_117, v61_135, 0)
	byte CVZNX_137 = cond(v61_135)
	d4_145 = d4_126 - 0x01
	branch d4_145 != ~0x00 l000018FC
l000018F2:
	word32 a0_168 = a0_10 + 0x01
	wLoc02_129 = DPB(wLoc02_129, Mem0[a0_168 + 0x00:byte], 0) (alias)
	a0_10 = a0_168 + 0x01
	d5_136 = DPB(d5_117, wLoc02_129, 0)
	d4_145 = 0x0F
l000018FC:
	d3_105 = DPB(d3_134, __rcl(v59_133, 0x01, CVZNX_137) + 0x01, 0)
	a0_10 = a0_10 + 0x01
	d2_103 = DPB(-0x01, Mem0[a0_10 + 0x00:byte], 0)
	goto l0000191C
l00001906:
	word32 a0_206 = a0_10 + 0x01
	byte v41_209 = Mem0[a0_206 + 0x00:byte]
	word16 v47_220 = (word16) DPB(d1, v41_209, 0) & 0x07
	a0_10 = a0_206 + 0x01
	d2_103 = DPB(DPB(-0x01, v41_209, 0), Mem0[a0_10 + 0x00:byte], 0)
	d1 = DPB(d1, v47_220, 0)
	branch v47_220 == 0x00 l00001928
l00001918:
	word32 d3_227 = (int32) (byte) v47_220
	d3_105 = DPB(d3_227, (word16) d3_227 + 0x01, 0)
l0000191C:
	Mem112[a1 + 0x00:byte] = Mem0[a1 + d2_103:byte]
	a1 = a1 + 0x01
	d3_105 = d3_105 - 0x01
	branch d3_105 != ~0x00 l0000191C
l00001926:
	goto l000018A8
l00001928:
	byte v55_231 = Mem0[a0_206 + 0x01:byte]
	a0_10 = a0_206 + 0x02
	d1 = DPB(d1, v55_231, 0)
	branch v55_231 == 0x00 l00001938
l0000192C:
	branch v55_231 == 0x01 l000018A8
l00001934:
	d3_105 = (int32) v55_231
	goto l0000191C
l00001938:
	return
fn0000189C_exit:
}

