#region License
/* 
 * Copyright (C) 1999-2019 John Källén.
 *
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation; either version 2, or (at your option)
 * any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program; see the file COPYING.  If not, write to
 * the Free Software Foundation, 675 Mass Ave, Cambridge, MA 02139, USA.
 */
#endregion

using Reko.Core.Machine;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace Reko.Arch.Vax
{
    using Decoder = Decoder<VaxDisassembler, Opcode, VaxInstruction>;

    public partial class VaxDisassembler
    {
        private static Decoder[] twoByteInstructions = new[]
        {
/* 00FD */ Instr(Opcode.Reserved, -1),
/* 01FD */ Instr(Opcode.Reserved, -1),
/* 02FD */ Instr(Opcode.Reserved, -1),
/* 03FD */ Instr(Opcode.Reserved, -1),
/* 04FD */ Instr(Opcode.Reserved, -1),
/* 05FD */ Instr(Opcode.Reserved, -1),
/* 06FD */ Instr(Opcode.Reserved, -1),
/* 07FD */ Instr(Opcode.Reserved, -1),
/* 08FD */ Instr(Opcode.Reserved, -1),
/* 30FD */ Instr(Opcode.Reserved, -1),
/* 31FD */ Instr(Opcode.mfvp, -1),
/* 32FD */ Instr(Opcode.cvtdh, -1),
/* 33FD */ Instr(Opcode.cvtgf, -1),
/* 34FD */ Instr(Opcode.vldl, -1),
/* 35FD */ Instr(Opcode.vgathl, -1),
/* 36FD */ Instr(Opcode.vldq, -1),
/* 37FD */ Instr(Opcode.vgathq, -1),
/* 38FD */ Instr(Opcode.Reserved, -1),
/* 09FD */ Instr(Opcode.Reserved, -1),
/* 39FD */ Instr(Opcode.Reserved, -1),
/* 0AFD */ Instr(Opcode.Reserved, -1),
/* 3AFD */ Instr(Opcode.Reserved, -1),
/* 0BFD */ Instr(Opcode.Reserved, -1),
/* 3BFD */ Instr(Opcode.Reserved, -1),
/* 0CFD */ Instr(Opcode.Reserved, -1),
/* 3CFD */ Instr(Opcode.Reserved, -1),
/* 0DFD */ Instr(Opcode.Reserved, -1),
/* 3DFD */ Instr(Opcode.Reserved, -1),
/* 0EFD */ Instr(Opcode.Reserved, -1),
/* 3EFD */ Instr(Opcode.Reserved, -1),
/* 0FFD */ Instr(Opcode.Reserved, -1),
/* 3FFD */ Instr(Opcode.Reserved, -1),
/* 10FD */ Instr(Opcode.Reserved, -1),
/* 40FD */ Instr(Opcode.addg2, -1),
/* 11FD */ Instr(Opcode.Reserved, -1),
/* 41FD */ Instr(Opcode.addg3, -1),
/* 12FD */ Instr(Opcode.Reserved, -1),
/* 42FD */ Instr(Opcode.subg2, -1),
/* 13FD */ Instr(Opcode.Reserved, -1),
/* 43FD */ Instr(Opcode.subg3, -1),
/* 14FD */ Instr(Opcode.Reserved, -1),
/* 44FD */ Instr(Opcode.mulg2, -1),
/* 15FD */ Instr(Opcode.Reserved, -1),
/* 45FD */ Instr(Opcode.mulg3, -1),
/* 16FD */ Instr(Opcode.Reserved, -1),
/* 46FD */ Instr(Opcode.divg2, -1),
/* 17FD */ Instr(Opcode.Reserved, -1),
/* 47FD */ Instr(Opcode.divg3, -1),
/* 18FD */ Instr(Opcode.Reserved, -1),
/* 48FD */ Instr(Opcode.cvtgb, -1),
/* 19FD */ Instr(Opcode.Reserved, -1),
/* 49FD */ Instr(Opcode.cvtgw, -1),
/* 1AFD */ Instr(Opcode.Reserved, -1),
/* 4AFD */ Instr(Opcode.cvtgl, -1),
/* 1BFD */ Instr(Opcode.Reserved, -1),
/* 4BFD */ Instr(Opcode.cvtrgl, -1),
/* 1CFD */ Instr(Opcode.Reserved, -1),
/* 4CFD */ Instr(Opcode.cvtbg, -1),
/* 1DFD */ Instr(Opcode.Reserved, -1),
/* 4DFD */ Instr(Opcode.cvtwg, -1),
/* 1EFD */ Instr(Opcode.Reserved, -1),
/* 4EFD */ Instr(Opcode.cvtlg, -1),
/* 1FFD */ Instr(Opcode.Reserved, -1),
/* 4FFD */ Instr(Opcode.acbg,  rg,rg,mg,bw),
/* 20FD */ Instr(Opcode.Reserved, -1),
/* 50FD */ Instr(Opcode.movg, -1),
/* 21FD */ Instr(Opcode.Reserved, -1),
/* 51FD */ Instr(Opcode.cmpg, -1),
/* 22FD */ Instr(Opcode.Reserved, -1),
/* 52FD */ Instr(Opcode.mnegg, -1),
/* 23FD */ Instr(Opcode.Reserved, -1),
/* 53FD */ Instr(Opcode.tstg, -1),
/* 24FD */ Instr(Opcode.Reserved, -1),
/* 54FD */ Instr(Opcode.emodg,  rg,rb,rd,wl,wg),
/* 25FD */ Instr(Opcode.Reserved, -1),
/* 55FD */ Instr(Opcode.polyg,  rg,rw,ab), 
/* 26FD */ Instr(Opcode.Reserved, -1),
/* 56FD */ Instr(Opcode.cvtgh, -1),
/* 27FD */ Instr(Opcode.Reserved, -1),
/* 57FD */ Instr(Opcode.Reserved, -1),
/* 28FD */ Instr(Opcode.Reserved, -1),
/* 58FD */ Instr(Opcode.Reserved, -1),
/* 29FD */ Instr(Opcode.Reserved, -1),
/* 59FD */ Instr(Opcode.Reserved, -1),
/* 2AFD */ Instr(Opcode.Reserved, -1),
/* 5AFD */ Instr(Opcode.Reserved, -1),
/* 2BFD */ Instr(Opcode.Reserved, -1),
/* 5BFD */ Instr(Opcode.Reserved, -1),
/* 2CFD */ Instr(Opcode.Reserved, -1),
/* 5CFD */ Instr(Opcode.Reserved, -1),
/* 2DFD */ Instr(Opcode.Reserved, -1),
/* 5DFD */ Instr(Opcode.Reserved, -1),
/* 2EFD */ Instr(Opcode.Reserved, -1),
/* 5EFD */ Instr(Opcode.Reserved, -1),
/* 2FFD */ Instr(Opcode.Reserved, -1),
/* 5FFD */ Instr(Opcode.Reserved, -1),
/* 60FD */ Instr(Opcode.addh2, rh,wh),
/* 90FD */ Instr(Opcode.Reserved, -1),
/* 61FD */ Instr(Opcode.addh3, rh,rh,wh),
/* 91FD */ Instr(Opcode.Reserved, -1),
/* 62FD */ Instr(Opcode.subh2, rh,wh),
/* 92FD */ Instr(Opcode.Reserved, -1),
/* 63FD */ Instr(Opcode.subh3, rh,rh,wh),
/* 93FD */ Instr(Opcode.Reserved, -1),
/* 64FD */ Instr(Opcode.mulh2, rh,wh),
/* 94FD */ Instr(Opcode.Reserved, -1),
/* 65FD */ Instr(Opcode.mulh3, rh,rh,wh),
/* 95FD */ Instr(Opcode.Reserved, -1),
/* 66FD */ Instr(Opcode.divh2, rh,wh),
/* 96FD */ Instr(Opcode.Reserved, -1),
/* 67FD */ Instr(Opcode.divh3, rh,rh,wh),
/* 97FD */ Instr(Opcode.Reserved, -1),
/* 68FD */ Instr(Opcode.cvthb, -1),
/* 98FD */ Instr(Opcode.cvtfh, -1),
/* 69FD */ Instr(Opcode.cvthw, -1),
/* 99FD */ Instr(Opcode.cvtfg, -1),
/* 6AFD */ Instr(Opcode.cvthl, -1),
/* 9AFD */ Instr(Opcode.Reserved, -1),
/* 6BFD */ Instr(Opcode.cvtrhl, -1),
/* 9BFD */ Instr(Opcode.Reserved, -1),
/* 6CFD */ Instr(Opcode.cvtbh, -1),
/* 9CFD */ Instr(Opcode.vstl, -1),
/* 6DFD */ Instr(Opcode.cvtwh, -1),
/* 9DFD */ Instr(Opcode.vscatl, -1),
/* 6EFD */ Instr(Opcode.cvtlh, -1),
/* 9EFD */ Instr(Opcode.vstq, -1),
/* 6FFD */ Instr(Opcode.acbh,  rh,rh,mh,bw),
/* 9FFD */ Instr(Opcode.vscatq, -1),
/* 70FD */ Instr(Opcode.movh, -1),
/* 71FD */ Instr(Opcode.cmph, -1),
/* 72FD */ Instr(Opcode.mnegh, -1),
/* 73FD */ Instr(Opcode.tsth, -1),
/* 74FD */ Instr(Opcode.emodh,  rh,rb,rd,wl,wh),
/* 75FD */ Instr(Opcode.polyh,  rh,rw,ab), 
/* 76FD */ Instr(Opcode.cvthg, -1),
/* 77FD */ Instr(Opcode.Reserved, -1),
/* 78FD */ Instr(Opcode.Reserved, -1),
/* 79FD */ Instr(Opcode.Reserved, -1),
/* 7AFD */ Instr(Opcode.Reserved, -1),
/* 7BFD */ Instr(Opcode.Reserved, -1),
/* 7CFD */ Instr(Opcode.clrh, -1), // clro, -1),
/* 7DFD */ Instr(Opcode.movo, -1),
/* 7EFD */ Instr(Opcode.movah, -1), //  movao, -1),
/* 7FFD */ Instr(Opcode.pushah, -1), // pushao, -1),


/* 80FD */ Instr(Opcode.vvaddl, -1),
/* 81FD */ Instr(Opcode.vsaddl, -1),
/* 82FD */ Instr(Opcode.vvaddg, -1),
/* 83FD */ Instr(Opcode.vsaddg, -1),
/* 84FD */ Instr(Opcode.vvaddf, -1),
/* 85FD */ Instr(Opcode.vsaddf, -1),
/* 86FD */ Instr(Opcode.vvaddd, -1),
/* 87FD */ Instr(Opcode.vsaddd, -1),
/* 88FD */ Instr(Opcode.vvsubl, -1),
/* 89FD */ Instr(Opcode.vssubl, -1),
/* 8AFD */ Instr(Opcode.vvsubg, -1),
/* 8BFD */ Instr(Opcode.vssubg, -1),
/* 8CFD */ Instr(Opcode.vvsubf, -1),
/* 8DFD */ Instr(Opcode.vssubf, -1),
/* 8EFD */ Instr(Opcode.vvsubd, -1),
/* 8FFD */ Instr(Opcode.vssubd, -1),

/* A0FD */ Instr(Opcode.vvmull, -1),
/* A1FD */ Instr(Opcode.vsmull, -1),
/* A2FD */ Instr(Opcode.vvmulg, -1),
/* A3FD */ Instr(Opcode.vsmulg, -1),
/* A4FD */ Instr(Opcode.vvmulf, -1),
/* A5FD */ Instr(Opcode.vsmulf, -1),
/* A6FD */ Instr(Opcode.vvmuld, -1),
/* A7FD */ Instr(Opcode.vsmuld, -1),
/* A8FD */ Instr(Opcode.vsync, -1),
/* A9FD */ Instr(Opcode.mtvp, -1),
/* AAFD */ Instr(Opcode.vvdivg, -1),
/* ABFD */ Instr(Opcode.vsdivg, -1),
/* ACFD */ Instr(Opcode.vvdivf, -1),
/* ADFD */ Instr(Opcode.vsdivf, -1),
/* AEFD */ Instr(Opcode.vvdivd, -1),
/* AFFD */ Instr(Opcode.vsdivd, -1),

/* B0FD */ Instr(Opcode.Reserved, -1),
/* B1FD */ Instr(Opcode.Reserved, -1),
/* B2FD */ Instr(Opcode.Reserved, -1),
/* B3FD */ Instr(Opcode.Reserved, -1),
/* B4FD */ Instr(Opcode.Reserved, -1),
/* B5FD */ Instr(Opcode.Reserved, -1),
/* B6FD */ Instr(Opcode.Reserved, -1),
/* B7FD */ Instr(Opcode.Reserved, -1),
/* B8FD */ Instr(Opcode.Reserved, -1),
/* B9FD */ Instr(Opcode.Reserved, -1),
/* BAFD */ Instr(Opcode.Reserved, -1),
/* BBFD */ Instr(Opcode.Reserved, -1),
/* BCFD */ Instr(Opcode.Reserved, -1),
/* BDFD */ Instr(Opcode.Reserved, -1),
/* BEFD */ Instr(Opcode.Reserved, -1),
/* BFFD */ Instr(Opcode.Reserved, -1),

/* C0FD */ Instr(Opcode.vvcmpl, -1),
/* C1FD */ Instr(Opcode.vscmpl, -1),
/* C2FD */ Instr(Opcode.vvcmpg, -1),
/* C3FD */ Instr(Opcode.vscmpg, -1),
/* C4FD */ Instr(Opcode.vvcmpf, -1),
/* C5FD */ Instr(Opcode.vscmpf, -1),
/* C6FD */ Instr(Opcode.vvcmpd, -1),
/* C7FD */ Instr(Opcode.vscmpd, -1),
/* C8FD */ Instr(Opcode.vvbisl, -1),
/* C9FD */ Instr(Opcode.vsbisl, -1),
/* CAFD */ Instr(Opcode.Invalid, -1),
/* CBFD */ Instr(Opcode.Invalid, -1),
/* CCFD */ Instr(Opcode.vvbicl, -1),
/* CDFD */ Instr(Opcode.vsbicl, -1),
/* CEFD */ Instr(Opcode.Invalid, -1),
/* CFFD */ Instr(Opcode.Invalid, -1),

/* D0FD */ Instr(Opcode.Reserved, -1),
/* D1FD */ Instr(Opcode.Reserved, -1),
/* D2FD */ Instr(Opcode.Reserved, -1),
/* D3FD */ Instr(Opcode.Reserved, -1),
/* D4FD */ Instr(Opcode.Reserved, -1),
/* D5FD */ Instr(Opcode.Reserved, -1),
/* D6FD */ Instr(Opcode.Reserved, -1),
/* D7FD */ Instr(Opcode.Reserved, -1),
/* D8FD */ Instr(Opcode.Reserved, -1),
/* D9FD */ Instr(Opcode.Reserved, -1),
/* DAFD */ Instr(Opcode.Reserved, -1),
/* DBFD */ Instr(Opcode.Reserved, -1),
/* DCFD */ Instr(Opcode.Reserved, -1),
/* DDFD */ Instr(Opcode.Reserved, -1),
/* DEFD */ Instr(Opcode.Reserved, -1),
/* DFFD */ Instr(Opcode.Reserved, -1),

/* E0FD */ Instr(Opcode.vvsrll, -1),
/* E1FD */ Instr(Opcode.vssrll, -1),
/* E2FD */ Instr(Opcode.Invalid, -1),
/* E3FD */ Instr(Opcode.Invalid, -1),
/* E4FD */ Instr(Opcode.vvslll, -1),
/* E5FD */ Instr(Opcode.vsslll, -1),
/* E6FD */ Instr(Opcode.Invalid, -1),
/* E7FD */ Instr(Opcode.Invalid, -1),
/* E8FD */ Instr(Opcode.vvxorl, -1),
/* E9FD */ Instr(Opcode.vsxorl, -1),
/* EAFD */ Instr(Opcode.Invalid, -1),
/* EBFD */ Instr(Opcode.Invalid, -1),
/* ECFD */ Instr(Opcode.vvcvt, -1),
/* EDFD */ Instr(Opcode.iota, -1),
/* EEFD */ Instr(Opcode.vvmerge, -1),
/* EFFD */ Instr(Opcode.vsmerge, -1),

/* F0FD */ Instr(Opcode.Reserved, -1),
/* F1FD */ Instr(Opcode.Reserved, -1),
/* F2FD */ Instr(Opcode.Reserved, -1),
/* F3FD */ Instr(Opcode.Reserved, -1),
/* F4FD */ Instr(Opcode.Reserved, -1),
/* F5FD */ Instr(Opcode.Reserved, -1),
/* F6FD */ Instr(Opcode.cvthf, -1),
/* F7FD */ Instr(Opcode.cvthd, -1),
/* F8FD */ Instr(Opcode.Reserved, -1),
/* F9FD */ Instr(Opcode.Reserved, -1),
/* FAFD */ Instr(Opcode.Reserved, -1),
/* FBFD */ Instr(Opcode.Reserved, -1),
/* FCFD */ Instr(Opcode.Reserved, -1),
/* FCFE */ Instr(Opcode.Reserved, -1),
/* FCFF */ Instr(Opcode.Reserved, -1),

/* FDFF */ Instr(Opcode.bugl, -1),
/* FEFF */ Instr(Opcode.bugw, -1),
/* FFFF */ Instr(Opcode.Reserved   , -1), // invalid opcode, basically

    };
    }
}
